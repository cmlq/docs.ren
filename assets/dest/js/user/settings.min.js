define(["jquery","vue","gf"],function(e,t,a){e("#set-tab").children(":gt(0)").on("click",function(){var t=e(this).index();e(this).siblings().removeClass("active").end().addClass("active"),e(".set-content").children().not(".hide").addClass("hide").end().eq(t).removeClass("hide")}),t.config.delimiters=["<%","%>"];{var s={keywords:"",description:"",helplink:"",statistics:""},r={type:"",search:"",page:0,users:[],extra:{}},o={type:"",search:"",page:0,posts:[],extra:{}},n={categoryName:"",categories:[]};new t({el:"#base-set",data:s,methods:{save:function(t){t.preventDefault(),e.ajax({url:"/webset",type:"POST",data:this.$data}).then(function(e){e.status&&a("success",e.msg)})}}}),new t({el:"#set-user",data:r,ready:function(){this.userList()},methods:{userList:function(t,s){var r=this;return t&&(r.type=t),"search"!==t||r.search?(!!s&&(r.page=0),r.page++,e(".loader").hasClass("hide")&&e(".loader").removeClass("hide"),void e.ajax({url:"/userManagement",type:"POST",data:{page:r.page,type:r.type,search:r.search}}).then(function(t){e(".loader").hasClass("hide")||e(".loader").addClass("hide"),!!s&&(r.users.length=0),r.users=r.users.concat(t.users),r.extra=t.extra})):void a("error","搜索内容不能为空")},delUser:function(t){var s=confirm("确定删除此用户吗？"),r=s&&confirm("删除用户将会删除此用户相关，动态、通知、文章以及评论，请谨慎操作"),o=t.target.dataset.id;r&&e.ajax({url:"/delUser",type:"POST",data:{id:o}}).then(function(s){s.status?(a("success",s.msg),e(t.target).closest("tr").remove()):a("error",s.msg)},function(){})}}}),new t({el:"#set-post",data:o,ready:function(){this.loadmore()},methods:{loadmore:function(t,s){var r=this;return t&&(r.type=t),"search"!==t||r.search?(!!s&&(r.page=0),r.page++,e(".loader").hasClass("hide")&&e(".loader").removeClass("hide"),void e.ajax({url:"/setPost",type:"POST",data:{page:r.page,type:r.type,search:r.search}}).then(function(t){e(".loader").hasClass("hide")||e(".loader").addClass("hide"),!!s&&(r.posts.length=0),r.posts=r.posts.concat(t.posts),r.extra=t.extra})):void a("error","搜索内容不能为空")},del:function(t){var s=confirm("确定删除文章吗？"),r=t.target.dataset.id;s&&e.ajax({url:"/del",type:"POST",data:{id:r}}).then(function(s){s.status?(a("success",s.msg),e(t.target).closest("tr").remove()):a("error",s.msg)},function(){})}}}),new t({el:"#set-category",data:n,ready:function(){this.categorylist()},methods:{categorylist:function(){var t=this;e.ajax({url:"/categoryList",type:"POST"}).then(function(e){t.categories=e.categories})},addCategory:function(){var t=this;return t.categoryName?void e.ajax({url:"/addCategory",type:"POST",data:{name:t.categoryName}}).then(function(t){if(t.status){a("success",t.msg);var s=['<tr class="fade-in-up ng-enter">','<td class="v-middle"><a href="javascript:;">'+t.data.name+"</a></td>",'<td style="white-space: nowrap">','<div class="buttons">','<button class="btn btn-sm btn-danger" disabled>删除</button>',"</div>","</td>","</tr>"].join(" ");e("#category-tr").after(s)}else a("error",t.msg)}):void a("error","分类名不能为空")},removeCategory:function(t,s){var r=confirm("您确定要删除"+s+"分类吗？");r&&e.ajax({url:"/removeCategory",type:"POST",data:{name:s}}).then(function(s){s.status&&(a("success",s.msg),e(t.target).closest("tr").remove())})}}})}});