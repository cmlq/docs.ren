define(["petitspois","vue","vueValidator","upload","loadin","editor"],function(e,t,o,s,a){var c=new Editor;c.render(e("#editor")[0]),s.preview("docs-cover","",function(t){var o=t.replace(/^data:image\/\w+;base64,/,"")||"";a.show("load"),o&&e.ajax({url:"/docscover",type:"POST",data:{coverData:o}}).then(function(e){a.show("alert","上传成功","success"),e=JSON.parse(e),e.status&&(document.getElementById("docs-uri").placeholder=e.imguri)},function(){})}),t.use(o);new t({data:{docs:{title:"",tags:"",category:"",github:"",cover:"",description:"",content:"",istop:istop,isgood:isgood,recommend:recommend,iscomment:iscomment,cstatus:cstatus,edit:""}},methods:{submit:function(t){t.preventDefault(),c.codemirror.getValue()?this.docs.content=c.codemirror.getValue():a.show("alert","文档内容不能为空","danger");var o=document.getElementById("docs-uri").placeholder;o=/docscover/.test(o)?o:"",this.docs.cover=o;var s=this.docs.edit?"/docedit":"/create";a.show("load"),e.ajax({type:"POST",url:s,data:this.$data.docs}).then(function(e){e=JSON.parse(e),e.status?(a.show("alert",e.msg,"success"),setTimeout(function(){location.replace("/doc/"+e.data.id)},500)):a.show("alert",e.msg,"danger")},function(){})}}}).$mount("#docs-wrap")});